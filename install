BASHKIT_INSTALL=/usr/local/bashkit
BIN_FOLDER=/usr/local/bin
MESSAGE_INFO="bashkit is being installed to $BASHKIT_INSTALL for the user $(whoami)"

echo $MESSAGE_INFO
echo -e "\x1B[90m${MESSAGE_INFO//?/=}\x1B[39m"
echo "Installation requires sudo permissions:"

ME=$(whoami)

sudo sh <<EOF
	[ -e $BASHKIT_INSTALL ] && echo "\x1B[31mInstall folder is not empty\x1B[39m" && exit 1
	echo "Installing now..."
	git clone -q git://github.com/mafintosh/bashkit.git $BASHKIT_INSTALL 2> /dev/null || (echo "\x1B[31mInstallation failed. Are you online?\x1B[39m" && exit 2)
	chown -R $ME $BASHKIT_INSTALL
	chown $ME $BIN_FOLDER
EOF

[ $? != 0 ] && exit 1

ln -s $BIN_FOLDER $BASHKIT_INSTALL/bin
mkdir -p $BASHKIT_INSTALL/apps
rm -f $BIN_FOLDER/bashkit
ln -s $BASHKIT_INSTALL/bashkit $BIN_FOLDER/bashkit

BASH_PROFILE="$HOME/.bash_profile"
[ ! -e $BASH_PROFILE ] && BASH_PROFILE="$HOME/.bashrc"

if cat $BASH_PROFILE 2> /dev/null | grep "## bashkit installation ##" > /dev/null; then
	: # already linked in rc
else
	printf '\n## bashkit installation ##\n[ -e %s ] && . %s\n' $BASHKIT_INSTALL/bashrc $BASHKIT_INSTALL/bashrc >> $BASH_PROFILE
fi

echo "Installation complete. Try running 'bashkit'"